<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OSINT Intelligence Dashboard</title>
<link rel="stylesheet" href="/static/styles.css">
</head>

<body>

<div class="app">

  <aside class="sidebar">
    <img src="/static/logo.png" class="logo">
    <h2>OSINT</h2>
    <p class="tagline">The quieter you are,<br>the more you hear</p>
  </aside>

  <main class="main">

    <div class="search-bar">
      <input id="searchInput" placeholder="Enter username…" />
      <select id="platformFilter">
        <option value="all">All Platforms</option>
        <option value="twitter">Twitter</option>
        <option value="instagram">Instagram</option>
        <option value="github">GitHub</option>
      </select>
      <button id="searchBtn">Run Check</button>
    </div>

    <div id="status" class="status"></div>
    <div id="results" class="results"></div>

  </main>

</div>

<script>
const searchBtn = document.getElementById("searchBtn");
const searchInput = document.getElementById("searchInput");
const platformFilter = document.getElementById("platformFilter");
const results = document.getElementById("results");
const status = document.getElementById("status");

searchBtn.onclick = async () => {
  const username = searchInput.value.trim();
  if (!username) return;

  status.innerText = "Running intelligence checks…";
  results.innerHTML = "";

  const res = await fetch("/api/check", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ username })
  });

  const data = await res.json();
  status.innerText = "";

  let profiles = data.profiles || [];

  if (platformFilter.value !== "all") {
    profiles = profiles.filter(p => p.platform === platformFilter.value);
  }

  if (profiles.length === 0) {
    status.innerText = "No profiles found.";
    return;
  }

  profiles.forEach(p => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <h3>${p.platform.toUpperCase()}</h3>
      <p>${p.username}</p>
      <a href="${p.url}" target="_blank">Open profile</a>
      <span class="risk risk-${p.nlp.risk}">${p.nlp.risk.toUpperCase()}</span>
    `;
    results.appendChild(card);
  });
};
</script>

</body>
</html>
